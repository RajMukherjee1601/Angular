<div class="container py-4">
  <div class="d-flex align-items-center justify-content-between">
    <h3>All Bookings</h3>
    <div class="d-flex gap-2">
      <select class="form-select form-select-sm" style="width: 180px;" [(ngModel)]="status" (change)="load(0)">
        <option value="">All statuses</option>
        <option value="BOOKED">BOOKED</option>
        <option value="PAID">PAID</option>
        <option value="PICKED_UP">PICKED_UP</option>
        <option value="IN_TRANSIT">IN_TRANSIT</option>
        <option value="DELIVERED">DELIVERED</option>
        <option value="CANCELLED">CANCELLED</option>
      </select>
      <button class="btn btn-outline-secondary btn-sm" (click)="exportCsv()">Export CSV</button>
    </div>
  </div>

  <div class="alert alert-danger mt-3" *ngIf="error">{{error}}</div>

  <table class="table table-striped mt-3" *ngIf="bookings.length">
    <thead>
      <tr>
        <th>Booking ID</th>
        <th>Customer</th>
        <th>Status</th>
        <th>Total</th>
        <th>Pickup/Drop</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let b of bookings">
        <td>{{b.bookingId}}</td>
        <td>{{b.customerEmail}}</td>
        <td>{{b.status}}</td>
        <td>{{b.totalCost}}</td>
        <td>
          <div>Pickup: {{b.pickupTime || '-'}}</div>
          <div>Drop: {{b.dropTime || '-'}}</div>
        </td>
        <td>
          <a class="btn btn-sm btn-outline-primary" [routerLink]="['/officer/status', b.bookingId]">Status</a>
          <a class="btn btn-sm btn-outline-primary ms-2" [routerLink]="['/officer/pickdrop', b.bookingId]">Pickup/Drop</a>
          <a class="btn btn-sm btn-outline-danger ms-2" [routerLink]="['/officer/cancel', b.bookingId]">Cancel</a>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="d-flex gap-2" *ngIf="totalPages > 1">
    <button class="btn btn-outline-secondary btn-sm" (click)="load(page-1)" [disabled]="page===0">Prev</button>
    <button class="btn btn-outline-secondary btn-sm" (click)="load(page+1)" [disabled]="page+1>=totalPages">Next</button>
    <span class="text-muted">Page {{page+1}} / {{totalPages}}</span>
  </div>
</div>
